---
// src/pages/index.astro
import "../styles/global.css";

const sports = [
  { slug: "baseball", label: "Baseball", icon: "âš¾" },
  { slug: "basketball", label: "Basketball", icon: "ğŸ€" },
  { slug: "football", label: "Football", icon: "ğŸˆ" },
];

const buildStamp = new Date().toISOString();
---

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <title>Card Gallery</title>
  </head>

  <body class="min-h-screen bg-zinc-950 text-zinc-100">
    <main class="mx-auto max-w-6xl px-4 py-10">
      <div class="rounded-3xl bg-gradient-to-b from-zinc-900/40 to-zinc-950 ring-1 ring-zinc-800 p-8 relative overflow-hidden">
        <div class="absolute -top-24 -right-20 h-72 w-72 rounded-full bg-indigo-500/10 blur-3xl"></div>
        <div class="absolute -bottom-20 -left-16 h-72 w-72 rounded-full bg-emerald-500/10 blur-3xl"></div>

        <div class="inline-flex items-center gap-2 rounded-full bg-zinc-900/60 ring-1 ring-zinc-800 px-3 py-1 text-sm text-zinc-200">
          âœ¨ BradyRip Card Vault
        </div>

        <h1 class="h1" style="margin-top:14px;">Browse my hits, rookies, and favorites.</h1>

<p class="subtle" style="margin-top:10px; max-width: 60ch;">
  Choose a sport â†’ choose a set â†’ tap a card to zoom.
</p>

        <div class="mt-6 grid gap-4 sm:grid-cols-2 lg:grid-cols-3">
          {sports.map((s) => (
            <a
              href={`/${s.slug}/`}
              class="group rounded-2xl bg-zinc-950 ring-1 ring-zinc-800 hover:ring-zinc-600 transition p-6"
            >
              <div class="text-sm text-zinc-300">{s.icon} {s.label}</div>
              <div class="mt-2 text-xl font-semibold tracking-tight">Browse sets â†’</div>
              <div class="mt-2 text-sm text-zinc-400">
                View all sets and card images.
              </div>
            </a>
          ))}
        </div>

<section class="card-of-week">
  <h2>Card of the Week</h2>

  <a id="cow-link" href="#" aria-label="Open Card of the Week">
    <img
      id="cow-img"
      src="/placeholder-card.webp"
      alt="Card of the Week"
      loading="lazy"
      style="max-width: 420px; width: 100%; height: auto; border-radius: 12px;"
    />
  </a>

  <p id="cow-meta" style="opacity: 0.8; margin-top: 8px;"></p>

  <script is:inline>
    async function pickCardOfWeek() {
      try {
        const res = await fetch("/good-cards.json", { cache: "no-store" });
        const data = await res.json();
        const cards = data?.cards ?? [];
        if (!cards.length) return;

        // Weighted random by score
        const weights = cards.map(c => (c.score ?? 0) + 1);
        const total = weights.reduce((a,b)=>a+b,0);
        let r = Math.random() * total;
        let pick = cards[cards.length - 1];
        for (let i = 0; i < cards.length; i++) {
          r -= weights[i];
          if (r <= 0) { pick = cards[i]; break; }
        }

        const img = document.getElementById("cow-img");
        const link = document.getElementById("cow-link");
        const meta = document.getElementById("cow-meta");

        img.src = pick.thumb;
        img.alt = `Card of the Week (${pick.sport}: ${pick.setSlug})`;
        link.href = pick.href;
        meta.textContent = `${pick.sport.toUpperCase()} â€¢ ${pick.setSlug}`;
      } catch (e) {
        console.warn("Card of the Week failed:", e);
      }
    }

    pickCardOfWeek();
  </script>
</section>


        <div class="card" style="padding:16px; margin-top:18px;">
  <div class="kicker">About</div>
  <div class="subtle" style="margin-top:6px;">
    Updated regularly â€” new uploads show up automatically.
  </div>
</div>
<!-- Contact (under About) -->
<div class="mt-4 card" style="padding: 14px 16px;">
  <div class="kicker">Contact</div>
  <p class="subtle" style="margin: 10px 0 0;">
    Email:
    <a class="btn" style="margin-left: 8px;" href="mailto:bradyripcards@gmail.com">
      bradyripcards@gmail.com
    </a>
  </p>
</div>


        <div class="mt-3 text-xs text-zinc-500">
          Build: {buildStamp}
        </div>
      </div>
    </main>
  </body>
</html>
